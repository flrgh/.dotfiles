#!/usr/bin/env bash

VERSION=${1:-latest}

if [[ $VERSION == latest ]]; then
    VERSION=$(gh-helper get-latest-tag sumneko/lua-language-server)
    echo "Latest version is $VERSION"
fi

URL=https://github.com/sumneko/lua-language-server/releases/download/${VERSION}/lua-language-server-${VERSION}-linux-x64.tar.gz

F=$(cache-get "$URL" lua-language-server-${VERSION}.tar.gz)

T=$(mktemp -d)

tar -C "$T" -xzf "$F"

mv "$T" "$HOME/.local/libexec/lua-language-server"
"$HOME"/.local/libexec/lua-language-server/bin/lua-language-server --version
